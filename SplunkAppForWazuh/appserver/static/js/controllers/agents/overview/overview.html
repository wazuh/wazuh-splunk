<div flex layout="column" layout-align="start stretch">

  <!-- Breadcrumbs -->
  <div layout="row" class="wz-height-35">
    <div class='wz-breadcrumb-margin'>
      <a class="wz-text-link cursor-pointer" ui-sref='agents'>Agents</a>
      <span> / </span>
      <span ng-if="!agent.error" class="wz-text-link cursor-pointer">{{agent.name}} ({{agent.id}})</span>
      <span ng-if="agent.error">Unknown agent</span>
      <span ng-if="agent.status">
        <span class="wz-agent-status-indicator small" ng-class="getAgentStatusClass(agent.status)"
          aria-label="Agent status indicator">{{formatAgentStatus(agent.status)}}</span>
      </span>
    </div>
  </div>
  <!-- End breadcrumbs -->

  <!-- Headline -->
  <div layout="column" layout-padding class="wz-margin-top--10">
    <div layout="row" class="wz-no-padding-bottom wz-margin-top--30">
      <span flex="" class="flex"></span>
      <button class="btn wz-button-empty pull-right ng-scope wz-margin-right-10" ng-click='openDiscover(agent.id)'
        tooltip="Discover">
        <wz-svg icon="compass"></wz-svg>
        Discover
      </button>
      <!-- Restart button -->
      <div ng-show="confirmingRestart" style="text-align: right;">
        <span style="padding-top: 8px;">The {{ agent.name}}({{agent.id}}) will be restarted.</span>
        <button style="height: 30px;" ng-if="isAdmin" ng-click="switchRestart()"
          class='btn wz-button-cancel pull-right wz-margin-left-10'>
          <span ng-show='isAdmin'><i aria-hidden='true' class='wz-margin-left-10'></i>Cancel</span>
        </button>
        <button style="height: 30px;" ng-if="isAdmin && !clusterEnabled" ng-click="restart(); switchRestart()"
          class='btn wz-button-empty pull-right wz-margin-left-10'>
          <span ng-show='isAdmin'><i aria-hidden='true' class='fa fa-fw fa-check wz-margin-left-10'></i>Confirm</span>
        </button>
      </div>
      <div ng-show="!confirmingRestart">
        <button ng-if="isAdmin && agent.status === 'Active'" ng-click="switchRestart()" ng-disabled="restartInProgress"
          class="btn wz-button-empty pull-right ng-scope">
          <span aria-hidden="false">
            <wz-svg icon="refresh"></wz-svg>
            Restart agent
          </span>
        </button>
      </div>
    </div>

    <!-- Agent info -->
    <div layout-padding class="wz-no-padding">
      <div class="wz-float-agent">
        <div class="wz-lh-32 agent-name-title">
          {{ agent.name || '-' }}
        </div>
      </div>
      <div class="agent-details-box">
        <div
          class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--directionRow euiFlexGroup--responsive">
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{ agent.id || '-' }}</p>
              </div>
              <p class="euiText--small euiStat__description">ID</p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{ agent.ip || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description">IP</p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{ agent.version || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description">Version</p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{ agentOS || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description">OS</p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{offsetTimestamp('', agent.dateAdd) || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description">Registration date</p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{offsetTimestamp('', agent.lastKeepAlive) || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description">Last keep alive</p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{offsetTimestamp('', syscheck.end) || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description" ng-if="syscheck.inProgress">Scan
                in progress</p>
              <p class="euiText--small euiStat__description" ng-if="!syscheck.inProgress">
                Last syscheck scan
                <md-tooltip ng-if="!syscheck.inProgress && syscheck.start && syscheck.end" md-direction="bottom"
                  class="wz-tooltip">
                  Start time: {{offsetTimestamp('', syscheck.start) || '-'}} <br>
                  End time: {{offsetTimestamp('', syscheck.end) || '-'}} <br>
                  Duration time: {{syscheck.duration +' minutes' || '-'}}
                </md-tooltip>
              </p>
            </div>
          </div>
          <div class="euiFlexItem euiFlexItem">
            <div class="euiStat euiStat--leftAligned wz-text-align-center">
              <div class="euiText euiText--small euiStat__description">
                <p class="agentField">{{offsetTimestamp('', rootcheck.end) || '-'}}</p>
              </div>
              <p class="euiText--small euiStat__description" ng-if="rootcheck.inProgress">Scan
                in progress</p>
              <p class="euiText--small euiStat__description" ng-if="!rootcheck.inProgress">Last rootcheck scan
                <md-tooltip ng-if="!rootcheck.inProgress && rootcheck.start && rootcheck.end" md-direction="bottom"
                  class="wz-tooltip">
                  Start time: {{offsetTimestamp('', rootcheck.start) || '-'}} <br>
                  End time: {{offsetTimestamp('', rootcheck.end) || '-'}} <br>
                  Duration time: {{rootcheck.duration + ' minutes' || '-'}}
                </md-tooltip>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <!-- End headline -->

  <div layout="column" ng-if="agent.error">
    <!-- No configuration card -->
    <md-card class="wz-md-card">
      <md-card-content class="wz-text-center">
        <i class="fa fa-fw fa-info-circle" aria-hidden="true"></i> <span class="wz-headline-title">Unable to load agent
          data</span>
        <md-divider class="wz-margin-top-10"></md-divider>
        <div layout="column" class="wz-padding-top-10">
          <p>{{agent.error}}</p>
        </div>
      </md-card-content>
    </md-card>
  </div>

  <div layout="row" layout-padding ng-if="!agent.error">
    <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">
      <div class="euiFlexItem flex-50">
        <div class="euiPanel euiPanel--paddingLarge">
          <h3 class="euiTitle wc-title welcome-card-main-title">Security Information Management</h3>
          <div class="extensions-eye"><md-tooltip class="wz-tooltip" md-direction="left">Show extensions list</md-tooltip><wz-svg ng-click="showExtensionsLists('security')" icon="eye" color="#396e3e" class="pull-right"></wz-svg></div>
          <div ng-show="extensionsLists.security" class="extensions-list">
            <ul class="noDot ul-extensions">
              <li><span class="wz-headline-title"><i class="fa fa-fw fa-amazon" aria-hidden="true"></i>Amazon AWS</span></li>
            </ul>
          </div>
          <div class="euiSpacer euiSpacer--m"></div>
          <div class="euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--halves">
            <wz-welcome-card class="euiFlexItem" logo="'/static/app/SplunkAppForWazuh/css/images/app_dashboard.svg'"
              sub-title="'Security events'" ui-sref='ag-general({id:agent.id})' current-tab="'general'"
              description="'Browse through your security alerts, identifying issues and threats in your environment.'">
            </wz-welcome-card>
            <wz-welcome-card class="euiFlexItem" logo="'/static/app/SplunkAppForWazuh/css/images/app_logging.svg'"
              sub-title="'Integrity monitoring'" ui-sref='ag-fim({id:agent.id})' current-tab="'fim'"
              description="'Alerts related to file changes, including permissions, content, ownership and attributes.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="!agent.error" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_devtools.svg'" sub-title="'Configuration'"
              ui-sref='ag-conf({id:agent.id})' current-tab="'configuration'"
              description="'Check the current agent configuration remotely applied by its group.'"></wz-welcome-card>
            <wz-welcome-card ng-if="!agent.error" ui-sref='ag-inventory({id:agent.id})' class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_index_pattern.svg'" sub-title="'Inventory data'"
              switch-tab="switchTab('syscollector')" current-tab="'syscollector'"
              description="'Applications, network configuration, open ports and processes running on your monitored systems.'">
            </wz-welcome-card>
          </div>
        </div>
      </div>
      <div class="euiFlexItem flex-50">
        <div class="euiPanel euiPanel--paddingLarge">
          <h3 class="euiTitle wc-title welcome-card-main-title">Auditing and Policy Monitoring</h3>
          <div class="extensions-eye"><md-tooltip class="wz-tooltip" md-direction="left">Show extensions list</md-tooltip><wz-svg ng-click="showExtensionsLists('auditing')" icon="eye" color="#396e3e" class="pull-right"></wz-svg></div>
          <div ng-show="extensionsLists.auditing" class="extensions-list"></div>
          <div class="euiSpacer euiSpacer--m"></div>
          <div class="euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--halves">
            <wz-welcome-card class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_advanced_settings.svg'"
              sub-title="'Policy monitoring'" ui-sref='ag-pm({id:aoc.agent.id})' current-tab="'pm'"
              description="'Configuration to ensure compliance with security policies, standards and hardening guides'">
            </wz-welcome-card>
            <wz-welcome-card class="euiFlexItem" logo="'/static/app/SplunkAppForWazuh/css/images/app_sca.svg'"
              sub-title="'Security Configuration Assessment'" ui-sref='ag-ca({id:aoc.agent.id})'
              current-tab="'conf-assess'" description="'Scan your assets as part of a configuration assessment audit.'">
            </wz-welcome-card>
            <wz-welcome-card class="euiFlexItem" logo="'/static/app/SplunkAppForWazuh/css/images/app_monitoring.svg'"
              sub-title="'System auditing'" ui-sref='ag-audit({id:agent.id})' ng-if="audit && isLinux"
              current-tab="'audit'"
              description="'Audit users behavior, monitoring command execution and alerting on access to critical files.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="oscap && isLinux" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_discover.svg'" sub-title="'Open SCAP'"
              ui-sref='ag-os({id:agent.id})' current-tab="'oscap'"
              description="'Configuration assessment and automation of compliance monitoring using SCAP checks.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if='ciscat' ui-sref='ag-ciscat({id:agent.id})' class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_advanced_settings.svg'" sub-title="'CIS-CAT'"
              switch-tab="switchTab('ciscat')" current-tab="'ciscat'"
              description="'Configuration assessment using Center of Internet Security scanner and SCAP checks.'">
            </wz-welcome-card>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div layout="row" layout-padding ng-if="!agent.error">
    <div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--responsive">
      <div class="euiFlexItem flex-50">
        <div class="euiPanel euiPanel--paddingLarge">
          <h3 class="euiTitle wc-title welcome-card-main-title">Threat Detection and Response</h3>
          <div class="extensions-eye"><md-tooltip class="wz-tooltip" md-direction="left">Show extensions list</md-tooltip><wz-svg ng-click="showExtensionsLists('threadDetection')" icon="eye" color="#396e3e" class="pull-right"></wz-svg></div>
          <div ng-show="extensionsLists.threadDetection" class="extensions-list"></div>
          <div class="euiSpacer euiSpacer--m"></div>
          <div class="euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--halves">
            <wz-welcome-card class="euiFlexItem" logo="'/static/app/SplunkAppForWazuh/css/images/app_security.svg'"
              sub-title="'Vulnerabilities'" ui-sref='ag-vul({id:agent.id})' current-tab="'vuls'"
              description="'Discover what applications are affected by well-known vulnerabilities'"></wz-welcome-card>
            <wz-welcome-card ng-if="virustotal" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_saved_objects.svg'" sub-title="'VirusTotal'"
              ui-sref='ag-virustotal' current-tab="'virustotal'"
              description="'Alerts resulting from VirusTotal analysis of suspicious files via an integration with their API.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="osquery" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/osquery.svg'" sub-title="'Osquery'" ui-sref='ag-osquery'
              current-tab="'osquery'"
              description="'Osquery allows to expose an operating system as a high-performance relational database.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="docker" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/docker.svg'" sub-title="'Docker listener'"
              ui-sref='ag-docker' current-tab="'docker'"
              description="'Collects events on Docker containers such as starting, stopping or pausing.'">
            </wz-welcome-card>
          </div>
        </div>
      </div>
      <div ng-if="gdpr || pci" class="euiFlexItem flex-50">
        <div class="euiPanel euiPanel--paddingLarge">
          <h3 class="euiTitle wc-title welcome-card-main-title">Regulatory Compliance</h3>
          <div class="extensions-eye"><md-tooltip class="wz-tooltip" md-direction="left">Show extensions list</md-tooltip><wz-svg ng-click="showExtensionsLists('regulatory')" icon="eye" color="#396e3e" class="pull-right"></wz-svg></div>
          <div ng-show="extensionsLists.regulatory" class="extensions-list"></div>
          <div class="euiSpacer euiSpacer--m"></div>
          <div class="euiFlexGrid euiFlexGrid--gutterLarge euiFlexGrid--halves">
            <wz-welcome-card ng-if="pci" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_apm.svg'" sub-title="'PCI DSS'"
              ui-sref='ag-pci({id:agent.id})' current-tab="'pci'"
              description="'Global security standard for entities that process, store or transmit payment cardholder data.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="gdpr" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_visualize.svg'" sub-title="'GDPR'"
              ui-sref='ag-gdpr({id:agent.id})' current-tab="'gdpr'"
              description="'General Data Protection Regulation (GDPR) sets guidelines for processing of personal data.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="hipaa" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_visualize.svg'" sub-title="'HIPAA'"
              ui-sref='ag-hipaa({id:agent.id})' current-tab="'gdpr'"
              description="'Health Insurance Portability and Accountability Act of 1996 (HIPAA) provides data privacy and security provisions for safeguarding medical information.'">
            </wz-welcome-card>
            <wz-welcome-card ng-if="nist" class="euiFlexItem"
              logo="'/static/app/SplunkAppForWazuh/css/images/app_visualize.svg'" sub-title="'NIST 800-53'"
              ui-sref='ag-nist({id:agent.id})' current-tab="'gdpr'"
              description="'National Institute of Standards and Technology Special Publication 800-53 (NIST 800-53) sets guidelines for federal information systems.'">
            </wz-welcome-card>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>