<div layout="row" class="md-padding" ng-show="wazuhTableLoading">
  <div class='uil-ring-css'>
    <div></div>
  </div>
</div>
</div>

<!-- Checkbox to hide columns -->
<div layout="row" ng-show="!error && !wazuhTableLoading && items.length" ng-class="{'show-checkboxes':showingChecks}">
  <div class="wz-table-checkboxes">
    <div ng-show="showingChecks" class="wz-margin-left-20">
      <md-checkbox ng-repeat="(key, value) in cleanKeys track by $index" ng-checked="value" ng-model="value" ng-change="switchKey(key)"
        aria-label="key">
        {{getEquivalence(key)}}
      </md-checkbox>
    </div>
  </div>
  <div ng-class="{'showing-checks':showingChecks, 'not-showing-checks':!showingChecks}">
    <span class="action-btn-td cursor-pointer" ng-click="showCheckbox()"><i aria-hidden="true" class="fa fa-cog"></i>
      <md-tooltip md-direction="left" class="wz-tooltip">
        Show or hide columns
      </md-tooltip>
    </span>
  </div>
</div>
<!-- End Checkbox -->

<!-- Table -->
<div layout="row" ng-show="!error && !wazuhTableLoading && items.length" ng-if="!isPolicyMonitoring() && !isSyschecks()">
  <table class="table wz-no-outline table-condensed" style="table-layout: fixed; " id="wz_table">
    <thead class="wz-text-bold">
      <th ng-repeat="key in keys | filter: showKey" class="wz-text-left" ng-class="{ 'cursor-pointer' : !key.nosortable, 'col-lg-1' : !key.size, 'col-lg-{{key.size}}' : key.size } && getWitdh(key.value || key)"
        ng-click="!key.nosortable && sort(key)">
        {{ path === '/agents/groups' && (key.value || key) === 'count' ? 'Agents' : keyEquivalence[key.value ||
        key] || key.value || key }}
        <i ng-if="!key.nosortable" class="fa wz-theader-sort-icon" ng-class="sortValue === (key.value || key) ? (sortDir ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort'"
          aria-hidden="true"></i>
      </th>
      <th ng-if="(path === '/agents' || (path === '/agents/groups' && adminMode) || (isLookingGroup() && adminMode)) && !isLookingDefaultGroup"
        class="wz-text-left" ng-class="{'col-lg-2': path !== '/agents', 'col-lg-1': path === '/agents'} && getWitdh(key.value || key)">Actions</th>
      <th ng-if="(path === '/rules/files' || path === '/decoders/files' || path === '/lists/files') && adminMode" class="wz-text-left">
        Actions
      </th>
    </thead>
    <tbody>
      <tr ng-class="allowClick ? 'cursor-pointer' : ''" class="wz-word-wrap" ng-repeat="item in pagedItems[currentPage] | filter:{item:'!'}"
        ng-click="clickAction(item)">
        <td ng-repeat="key in keys | filter: showKey" ng-if="path !== '/decoders' && path !== '/rules'" class="wz-text-truncatable">
          {{
          parseValue(key,item)
          }}
          <md-tooltip ng-if="parseValue(key,item).length > (extraLimit ? 100 : 25)" md-direction="bottom" class="wz-tooltip">
            {{ parseValue(key,item) }}
          </md-tooltip>
        </td>
        <td ng-repeat="key in keys | filter: showKey" ng-if="path === '/rules'" ng-click="key === 'id' && searchRuleId($event,item.id)"
          class="wz-text-truncatable">
          <span ng-if="key === 'id'" class="wz-text-left">
            {{ item.id }}
          </span>

          <span ng-if="key !== 'id'">
            {{
            parseValue(key,item)
            }}
          </span>
          <md-tooltip ng-if="parseValue(key,item).length > (extraLimit ? 100 : 25)" md-direction="bottom" class="wz-tooltip">
            {{ parseValue(key,item) }}
          </md-tooltip>
        </td>
        <td ng-repeat="key in keys | filter: showKey" ng-if="path === '/decoders'" class="wz-text-truncatable">
          <div class="wz-text-left" tooltip="{{ parseValue(key,item) }}" tooltip-placement="bottom">

            {{
            parseValue(key,item)
            }}
          </div>
          <md-tooltip ng-if="parseValue(key,item).length > (extraLimit ? 100 : 25)" md-direction="bottom" class="wz-tooltip">
            {{ parseValue(key,item) }}
          </md-tooltip>
        </td>
        <td ng-if="path === '/agents'" ng-click="$event.stopPropagation()" class="cursor-default action-btn-td">
          <p ng-click="clickAction(item, 'discover'); $event.stopPropagation()" class="fa fa-fw fa-compass cursor-pointer"></p>
          <md-tooltip>Open Discover panel for this agent"</md-tooltip>
          <i ng-click="clickAction(item, 'ag-conf'); $event.stopPropagation()" class="fa fa-fw fa-wrench cursor-pointer"></i>
          <md-tooltip>Open Configuration for this agent"</md-tooltip>
        </td>
        <!-- Remove files -->
        <td ng-if="adminMode && (path === '/rules/files' || path === '/decoders/files' || path === '/lists/files')">
          <i ng-if="!removingFile" ng-click="$event.stopPropagation();showConfirmRemoveFile($event, item.file || item.name); $event.stopPropagation()"
            class="fa fa-fw fa-trash cursor-pointer" aria-hidden="true" style="color: #0079a5;font-size: 17px;">
            <md-tooltip md-direction="left" class="wz-tooltip">
              Remove this file
            </md-tooltip>
          </i>
          <div ng-if="(item.file && removingFile === item.file) || (item.name && removingFile === item.name)" class="confirmEmbedBubble">
            <div class="inline" layout="row">
              <span class="font-size-12 wz-padding-left-8">This file will be removed</span>
            </div>
            <div class="inline" layout="row">
              <md-button class="cancelBtn" type="button" ng-click="$event.stopPropagation();cancelRemoveFile()"><i
                  aria-hidden='true' class='fa fa-fw fa-close'></i>
                Cancel</md-button>
              <md-button class="agreeBtn" type="button" ng-click="$event.stopPropagation();confirmRemoveFile(item)"><i
                  aria-hidden='true' class='fa fa-fw fa-check'></i> Confirm</md-button>
            </div>
          </div>
        </td>
        <!-- End remove files-->
        <td ng-if="path === '/agents/groups' && adminMode && !isLookingDefaultGroup" ng-click="$event.stopPropagation()"
          class="cursor-default action-btn-td" class="wz-text-truncatable">
          <span>
            <i ng-if="removingGroup !== item.name && item.name !== 'default'" ng-click="showConfirmRemoveGroup($event, item); $event.stopPropagation()"
              class="fa fa-fw fa-trash cursor-pointer" aria-hidden="true"></i>
            <md-tooltip md-direction="bottom" class="wz-tooltip">
              Remove this group
            </md-tooltip>
          </span>
          <span>
            <i ng-if="removingGroup !== item.name" ng-click="editGroup(item); $event.stopPropagation()" class="fa fa-fw fa-pencil cursor-pointer"
              tooltip="Edit this group configuration" tooltip-placement="left" aria-hidden="true"></i>
            <md-tooltip md-direction="bottom" class="wz-tooltip">
              Edit this group
            </md-tooltip>
          </span>
          <span class="wz-padding-left-8" ng-if="removingGroup !== item.name && item.name === 'default'">-</span>
          <div ng-if="removingGroup === item.name && item.name !== 'default'">
            <div layout="row">
              <span class="euiToastHeader__title font-size-12">Group {{item.name}} will be removed</span>
            </div>
            <div layout="row">
              <md-button class="cancelBtn" type="button" ng-click="cancelRemoveGroup()"><i aria-hidden='true' class='fa fa-fw fa-close'></i>
                Cancel</md-button>
              <md-button class="agreeBtn" type="button" ng-click="confirmRemoveGroup(item.name)"><i aria-hidden='true'
                  class='fa fa-fw fa-check'></i> Confirm</md-button>
            </div>
          </div>
        <td ng-if="isLookingGroup() && adminMode && !isLookingDefaultGroup" ng-click="$event.stopPropagation()" class="cursor-default action-btn-td">
          <i ng-if="removingAgent !== item.id && adminMode" ng-click="showConfirmRemoveAgentFromGroup($event, item); $event.stopPropagation()"
            class="fa fa-fw fa-trash cursor-pointer" tooltip="Remove this agent from the group" tooltip-placement="left"
            aria-hidden="true">
            <md-tooltip md-direction="right" class="wz-tooltip">
              Remove agent
            </md-tooltip>
          </i>
          <div ng-if="removingAgent === item.id" class="confirmEmbedBubble">
            <div layout="row">
              <span class="font-size-12 wz-padding-left-8">The agent {{item.id}} will be removed from
                this group</span>
            </div>
            <div layout="row">
              <md-button class="cancelBtn" type="button" ng-click="cancelRemoveAgent()"><i aria-hidden='true' class='fa fa-fw fa-close'></i>
                Cancel</md-button>
              <md-button class="agreeBtn" type="button" ng-click="confirmRemoveAgent(item.id)"><i aria-hidden='true'
                  class='fa fa-fw fa-check'></i> Confirm</md-button>
            </div>
          </div>
        </td>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <td colspan="{{ (path === '/agents' || (path === '/agents/groups' && adminMode) || (path === '/rules/files' || path === '/decoders/files' || path === '/lists/files') || (isLookingGroup() && adminMode)) && !isLookingDefaultGroup ? keys.length + 1 : keys.length}}">
        <span ng-show="!wazuhTableLoading" class="color-grey">{{ totalItems }} items ({{time | number: 2}} seconds)</span>
        <div ng-show="items.length >= itemsPerPage" class="pagination pull-right" style="margin:0 !important">
          <ul layout="row">
            <li ng-show="currentPage" class="md-padding">
              <a href ng-click="prevPage()">« Prev</a>
            </li>

            <li ng-repeat="n in range(pagedItems.length, currentPage, currentPage + gap) " ng-class="{'wz-text-active': n == currentPage}"
              ng-click="setPage()" class="md-padding">
              <a href ng-bind="n + 1">1</a>
            </li>

            <li ng-show="currentPage < pagedItems.length - 1" class="md-padding">
              <a href ng-click="nextPage()">Next »</a>
            </li>
          </ul>
        </div>
      </td>
    </tfoot>
  </table>
</div>


<!-- Table for configuration assessment -->
<div layout="row" ng-show="!error && !wazuhTableLoading && items.length" ng-if="isPolicyMonitoring()">
  <table class="table wz-no-outline table-condensed" style="table-layout: fixed !important" id="wz_table">
    <thead class="wz-text-bold">
      <th ng-repeat="key in keys" class="wz-text-left" ng-class="{ 'cursor-pointer' : !key.nosortable, 'col-lg-1' : !key.size, 'col-lg-{{key.size}}' : key.size }  && getWitdh(key.value || key)"
        ng-click="!key.nosortable && sort(key)">
        {{ path === '/agents/groups' && (key.value || key) === 'count' ? 'Agents' : keyEquivalence[key.value ||
        key] || key.value || key }}
        <i ng-if="!key.nosortable" class="fa wz-theader-sort-icon" ng-class="sortValue === (key.value || key) ? (sortDir ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort'"
          aria-hidden="true"></i>
      </th>
      <th ng-if="(path === '/agents' || (path === '/agents/groups' && adminMode) || (isLookingGroup() && adminMode)) && !isLookingDefaultGroup"
        class="wz-text-left" ng-class="{'col-lg-2': path !== '/agents', 'col-lg-1': path === '/agents'}  && getWitdh(key.value || key)">Actions</th>
    </thead>
    <tbody>
      <tr ng-class="allowClick ? 'cursor-pointer' : ''" class="wz-word-wrap" ng-repeat-start="item in pagedItems[currentPage] | filter:{item:'!'}"
        ng-click="expandItem(item)">
        <td ng-repeat="key in keys">
          <span>
            {{
            parseValue(key,item)
            }}
          </span>
        </td>
      </tr>
      <tr class="wz-word-wrap" style="background-color: #ecf6fb !important" ng-if="item.expanded" ng-repeat-end="">
        <td colspan="3">
          <div layout="column" ng-if="item.rationale" class="wz-margin-top-10">
            <span class="wz-headline-title"><strong>Rationale</strong></span>
            <md-divider class="wz-margin-top-10"></md-divider>
            <p class="wz-margin-top-10">{{item.rationale}}</p>
          </div>
          <div layout="column" ng-if="item.remediation" class="wz-margin-top-10">
            <span class="wz-headline-title"><strong>Remediation</strong></span>
            <md-divider class="wz-margin-top-10"></md-divider>
            <p class="wz-margin-top-10">{{item.remediation}}</p>
          </div>
          <div layout="column" ng-if="item.directory" class="wz-margin-top-10">
            <span class="wz-headline-title"><strong>Path(s)</strong></span>
            <md-divider class="wz-margin-top-10"></md-divider>
            <p class="wz-margin-top-10">{{ item.directory }}</p>
          </div>
          <div layout="column" ng-if="item.compliance" class="wz-margin-top-10">
            <span class="wz-headline-title"><strong>Compliance</strong></span>
            <md-divider class="wz-margin-top-10"></md-divider>
            <p class="wz-margin-top-10"><span class="wz-padding-right-8" ng-repeat="c in item.compliance">{{c.key}}/{{c.value}}</span></p>
          </div>
          <div layout="column" class="wz-margin-top-10"></div>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <td colspan="{{ (path === '/agents' || (path === '/agents/groups' && adminMode) || (isLookingGroup() && adminMode)) && !isLookingDefaultGroup ? keys.length + 1 : keys.length}}">
        <span ng-show="!wazuhTableLoading" class="color-grey">{{ totalItems }} items ({{time | number: 2}} seconds)</span>
        <div ng-show="items.length >= itemsPerPage" class="pagination pull-right" style="margin:0 !important">
          <ul layout="row">
            <li ng-show="currentPage" class="md-padding">
              <a href ng-click="prevPage()">« Prev</a>
            </li>

            <li ng-repeat="n in range(pagedItems.length, currentPage, currentPage + gap) " ng-class="{'wz-text-active': n == currentPage}"
              ng-click="setPage()" class="md-padding">
              <a href ng-bind="n + 1">1</a>
            </li>

            <li ng-show="currentPage < pagedItems.length - 1" class="md-padding">
              <a href ng-click="nextPage()">Next »</a>
            </li>
          </ul>
        </div>
      </td>
    </tfoot>
  </table>
</div>


<!-- Table for syschecks -->
<div layout="row" ng-show="!error && !wazuhTableLoading && items.length" ng-if="isSyschecks()">
  <table class="table wz-no-outline table-condensed" style="table-layout: fixed !important" id="wz_table">
    <thead class="wz-text-bold">
      <th ng-repeat="key in keys" class="wz-text-left" ng-class="{ 'cursor-pointer' : !key.nosortable, 'col-lg-1' : !key.size, 'col-lg-{{key.size}}' : key.size} && getWitdh(key.value || key)"
        ng-click="!key.nosortable && sort(key)">
        {{ keyEquivalence[key.value || key] || key.value || key }}
        <i ng-if="!key.nosortable" class="fa wz-theader-sort-icon" ng-class="sortValue === (key.value || key) ? (sortDir ? 'fa-sort-asc' : 'fa-sort-desc') : 'fa-sort'"
          aria-hidden="true"></i>
      </th>
    </thead>
    <tbody>
      <tr ng-class="allowClick ? 'cursor-pointer' : ''" class="wz-word-wrap" ng-repeat-start="item in pagedItems[currentPage] | filter:{item:'!'}"
        ng-click="expandItem(item)">
        <td ng-repeat="key in keys">
          <span>
            {{
            parseValue(key,item)
            }}
          </span>
        </td>
      </tr>
      <tr class="wz-word-wrap" style="background-color: #ecf6fb !important" ng-if="item.expanded" ng-repeat-end="">
        <td colspan="9">
          <md-card class="wz-margin-12">
            <table class="table wz-no-outline table-condensed">
              <tbody>
                <tr ng-repeat="(key,value) in item">
                  <td class="wz-width-150"><b>{{keyEquivalence[key] || key}}</b></td>
                  <td>{{value}}</td>
                </tr>
              </tbody>
            </table>
          </md-card>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <td colspan="{{ (path === '/agents' || (path === '/agents/groups' && adminMode) || (isLookingGroup() && adminMode)) && !isLookingDefaultGroup ? keys.length + 1 : keys.length}}">
        <span ng-show="!wazuhTableLoading" class="color-grey">{{ totalItems }} items ({{time | number: 2}} seconds)</span>
        <div ng-show="items.length >= itemsPerPage" class="pagination pull-right" style="margin:0 !important">
          <ul layout="row">
            <li ng-show="currentPage" class="md-padding">
              <a href ng-click="prevPage()">« Prev</a>
            </li>

            <li ng-repeat="n in range(pagedItems.length, currentPage, currentPage + gap) " ng-class="{'wz-text-active': n == currentPage}"
              ng-click="setPage()" class="md-padding">
              <a href ng-bind="n + 1">1</a>
            </li>

            <li ng-show="currentPage < pagedItems.length - 1" class="md-padding">
              <a href ng-click="nextPage()">Next »</a>
            </li>
          </ul>
        </div>
      </td>
    </tfoot>
  </table>
</div>
<div layout="row" ng-if="!error && !wazuhTableLoading && !totalItems">
  <div flex class="euiCallOut euiCallOut--warning">
    <div class="euiCallOutHeader">
      <svg class="euiIcon euiIcon--medium euiCallOutHeader__icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 16 16">
        <defs>
          <path id="help-a" d="M13.6 12.186l-1.357-1.358c-.025-.025-.058-.034-.084-.056.53-.794.84-1.746.84-2.773a4.977 4.977 0 0 0-.84-2.772c.026-.02.059-.03.084-.056L13.6 3.813a6.96 6.96 0 0 1 0 8.373zM8 15A6.956 6.956 0 0 1 3.814 13.6l1.358-1.358c.025-.025.034-.057.055-.084C6.02 12.688 6.974 13 8 13a4.978 4.978 0 0 0 2.773-.84c.02.026.03.058.056.083l1.357 1.358A6.956 6.956 0 0 1 8 15zm-5.601-2.813a6.963 6.963 0 0 1 0-8.373l1.359 1.358c.024.025.057.035.084.056A4.97 4.97 0 0 0 3 8c0 1.027.31 1.98.842 2.773-.027.022-.06.031-.084.056l-1.36 1.358zm5.6-.187A4 4 0 1 1 8 4a4 4 0 0 1 0 8zM8 1c1.573 0 3.019.525 4.187 1.4l-1.357 1.358c-.025.025-.035.057-.056.084A4.979 4.979 0 0 0 8 3a4.979 4.979 0 0 0-2.773.842c-.021-.027-.03-.059-.055-.084L3.814 2.4A6.957 6.957 0 0 1 8 1zm0-1a8.001 8.001 0 1 0 .003 16.002A8.001 8.001 0 0 0 8 0z"></path>
        </defs>
        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#help-a" fill-rule="evenodd"></use>
      </svg>
      <span class="euiCallOutHeader__title">{{customEmptyResults}}</span>
    </div>
  </div>
</div>

<div layout="row" ng-if="error" class="wz-margin-bottom-45">
  <div flex class="euiCallOut euiCallOut--warning">
    <div class="euiCallOutHeader">
      <svg class="euiIcon euiIcon--medium euiCallOutHeader__icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 16 16">
        <defs>
          <path id="help-a" d="M13.6 12.186l-1.357-1.358c-.025-.025-.058-.034-.084-.056.53-.794.84-1.746.84-2.773a4.977 4.977 0 0 0-.84-2.772c.026-.02.059-.03.084-.056L13.6 3.813a6.96 6.96 0 0 1 0 8.373zM8 15A6.956 6.956 0 0 1 3.814 13.6l1.358-1.358c.025-.025.034-.057.055-.084C6.02 12.688 6.974 13 8 13a4.978 4.978 0 0 0 2.773-.84c.02.026.03.058.056.083l1.357 1.358A6.956 6.956 0 0 1 8 15zm-5.601-2.813a6.963 6.963 0 0 1 0-8.373l1.359 1.358c.024.025.057.035.084.056A4.97 4.97 0 0 0 3 8c0 1.027.31 1.98.842 2.773-.027.022-.06.031-.084.056l-1.36 1.358zm5.6-.187A4 4 0 1 1 8 4a4 4 0 0 1 0 8zM8 1c1.573 0 3.019.525 4.187 1.4l-1.357 1.358c-.025.025-.035.057-.056.084A4.979 4.979 0 0 0 8 3a4.979 4.979 0 0 0-2.773.842c-.021-.027-.03-.059-.055-.084L3.814 2.4A6.957 6.957 0 0 1 8 1zm0-1a8.001 8.001 0 1 0 .003 16.002A8.001 8.001 0 0 0 8 0z"></path>
        </defs>
        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#help-a" fill-rule="evenodd"></use>
      </svg>
      <span class="euiCallOutHeader__title">{{error}}</span>
    </div>
  </div>
</div>


<div layout="row" ng-if="!wazuhTableLoading && !totalItems" class="wz-margin-top-10">
  <span class="color-grey">0 items ({{time | number: 2}} seconds)</span>
</div>